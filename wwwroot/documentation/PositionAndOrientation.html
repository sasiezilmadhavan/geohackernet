<!DOCTYPE html>
<html lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <link rel="icon" href="favicon.ico" />
    <title>Position and Orientation</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./resources/bootstrap.min.css">
    <link rel="stylesheet" href="./resources/jquery-ui-1.10.3.custom.css">
    <link rel="stylesheet" href="./resources/font-awesome.min.css">
    <link rel="stylesheet" href="./resources/prism.css">
    <link rel="stylesheet" href="./resources/demobrowser.css">
    <link rel="stylesheet" href="./resources/altus.css">
    <link rel="stylesheet" href="./resources/docs.css">
    <script src="./resources/jquery-1.9.1.min.js" type="text/javascript"></script>
    <script src="./resources/jquery-migrate-1.2.1.min.js" type="text/javascript"></script>
    <script src="./resources/bootstrap.js" type="text/javascript"></script>
    <script src="./resources/holder.js" type="text/javascript"></script>
    <script src="./resources/jquery-ui-1.10.3.custom.min.js" type="text/javascript"></script>
    <script src="./resources/prism.js" type="text/javascript"></script>
    <script src="./resources/demo.js" type="text/javascript"></script>
  </head>

  <body>
    <nav class="navbar navbar-inverse navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">

          <button class="navbar-toggle" type="button" data-toggle="collapse" data-target="navbar-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="PositionAndOrientation.html">Altus Platform - Position and Orientation</a>
        </div>

        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav navbar-right">
            <li id="Documentation"><a href="http://releases.ba3.us/latest/">Home</a></li>
            <li id="iOS"><a href="../../../iOS/AltusMappingEngine/documentation/index.html">iOS</a></li>
            <li id="Android"><a href="../../../Android/AltusMappingEngine/documentation/index.html">Android</a></li>
            <li id="Windows"><a href="../../../Windows/AltusMappingEngine/documentation/index.html">Windows</a></li>
            <li id="Web"><a href="../../../Web/AltusMappingEngine/documentation/index.html">Web</a></li>
            <li id="Server"><a href="../../../Unix/AltusServer/documentation/index.html">Server</a></li>
            <li><a href="http://www.ba3.us">BA3</a></li>
          </ul>
        </div>
      </div>
    </nav>

    <div class="container-fluid">
        <div class="row">
            <div class="col-sm-3 col-md-2 sidebar">
                <ul id="sidebar_list" class="nav nav-sidebar">
                </ul>
            </div>
            <div class="col-sm-9 col-sm-offset-3 col-md-10 col-md-offset-2 main">

    <h2 id="position-and-orientation">Position and Orientation</h2>
<p>Altus employs a 3D model for both the planet and how it is viewed. There are a variety of ways to change the location being 'observed' in the map view.</p>
<p>A virtual camera is used to set and control the location and orientation of the observer. Therefore, in order to change locations you change the placement of the virtual camera. The camera has several other properties that can be set like altitude and field of view.</p>
<p>These properties can also be animated to make the camera smoothely move from one location to another, one orientation to another, or a a combination.</p>
<p>You can:</p>
<ul>
<li>Instantly set the camera location</li>
<li>Instantly set the camera orientation</li>
<li>Smoothely change the camera location</li>
<li>Smoothely change the camera orientation</li>
<li>Set the camera field of view</li>
</ul>
<p>Under the hood, affine transformation matrices (transforms) are used as the mechanism for setting and updating the virtual camera location. This is because transformations can be easily composed (combined) and inverted. Therefore, setting the location or orientation of the camera involves creating and setting the camera's transform property.</p>
<h3 id="setting-position---2d">Setting Position - 2D</h3>
<p>As long as pitch is 90 degrees, and roll and yaw are 0, the view through the camera will always be looking down towards the centerpoint of the 3D sphere used to represent the planet at the point on the surface of that sphere directly beneath the camera. This gives the appearance of a 2D view of a map layer.</p>
<p>Here the camera is positioned over Mt. Ranier. North is up. The camera is pitch is 90 degrees. Positive pitch is down.</p>
<p>-&gt;<img src="Images/Documentation/Images/VirtualCameraStraightDown.png" alt="Camera straight down" />&lt;-</p>
<p>Here is the code for the camera placement:</p>

<pre><code class=language-javascript>/**Look down on Mt. Ranier*/
function lookDownAtMtRanier() {

    var lat = 46.852; //Degrees latitude
    var lon = -121.731; //Degrees longitude
    var altitude = 41888; //Meters above sea level
    var roll = 0; //Degrees (positive is clockwise)
    var pitch = 90; //Degrees (positive is 'down')
    var yaw = 0; //Degrees (positive is clockwise)

    //Create a new position
    var pos = new AltusUnified.GeographicPosition(lat, lon, altitude);

    //Create a new orientation
    var orientation = new AltusUnified.Orientation(0, 90, 0);

    //Scale is needed to construct a transform, but not used by the camera
    var scale = new AltusUnified.vec3d(1, 1, 1);

    //Create a new transform
    var trans = new AltusUnified.Transform(pos, orientation, scale);

    //Set the camera's transform
    AltusUnified.scene.camera().transform.set(trans);

    //Clean up
    pos.delete();
    orientation.delete();
    scale.delete();
}
</code></pre>

<h3 id="setting-orientation---3d">Setting Orientation - 3D</h3>
<p>If you change the pitch to anything other than 90 you are looking 'away' from the center of the planet at some angle. This is sometimes called &quot;tilting&quot; the view. This is useful when you have a 3D terrain layer or are displaying 3D models and their relationships to one another.</p>
<p>Here the camera is positioned to the south of Mt. Ranier. North is 'away' from the viewer. The camer pitch is horizontal (0 degrees).</p>
<p>-&gt;<img src="Images/Documentation/Images/VirtualCameraTilted.png" alt="Camera tilted" />&lt;-</p>
<p>Here is the code for the camera placement:</p>

<pre><code class=language-javascript>//Look horizontally at Mt. Ranier from a position south of it
function lookHorizontallyAtMtRanier() {

    var lat = 46.630; //Degrees latitude
    var lon = -121.756; //Degrees longitude
    var altitude = 5131; //Meters above sea level
    var roll = 0; //Degrees (positive is clockwise)
    var pitch = 90; //Degrees (positive is 'down')
    var yaw = 0; //Degrees (positive is clockwise)

    //Create a new position
    var pos = new AltusUnified.GeographicPosition(lat, lon, altitude);

    //Create a new orientation
    var orientation = new AltusUnified.Orientation(0, 0, 0);

    //Scale is needed to construct a transform, but not used by the camera
    var scale = new AltusUnified.vec3d(1, 1, 1);

    //Create a new transform
    var trans = new AltusUnified.Transform(pos, orientation, scale);

    //Set the camera's transform
    AltusUnified.scene.camera().transform.set(trans);

    //Clean up
    pos.delete();
    orientation.delete();
    scale.delete();
}
</code></pre>

Here are some more example so camera manipulation:

<pre><code class=language-javascript>/*Set camera orientation using roll, pitch, and yaw
 Note: We could also use transform.lookAt(vec3d worldPosition, vec3d up) without using roll pitch and yaw
 */
function setCameraOrientation(roll, pitch, yaw){
    var pos = AltusUnified.scene.camera().transform.geographicPosition();
    var orientation = new AltusUnified.Orientation(roll, pitch, yaw);
    var scale = AltusUnified.scene.camera().transform.scale();
    var trans = new AltusUnified.Transform(pos, orientation, scale);
    AltusUnified.scene.camera().transform.set(trans);
    trans.delete();
    pos.delete();
    orientation.delete();
    scale.delete();
}

/**Set camera position*/
function setCameraPosition(lat, lon, altitude) {
    var pos = new AltusUnified.GeographicPosition(lat, lon, altitude);
    var orientation = new AltusUnified.Orientation(0, 90, 0);
    var scale = new AltusUnified.vec3d(1, 1, 1);
    var trans = new AltusUnified.Transform(pos, orientation, scale);
    AltusUnified.scene.camera().transform.set(trans);
    trans.delete();
    pos.delete();
    orientation.delete();
    scale.delete();
};

/**Reset camera to over the U.S.*/
function resetCamera() {
    setCameraPosition(39, -98, 10000000);
};

function lookAtUS() {
    setCameraPosition(39, -98, 5000000);
}
</code></pre>


            </div>
        </div>
        <hr>
        <p align="right">AltusMappingEngine Web v2.0.ut.2153.g60764257e master</p>
        <p align="right">COPYRIGHT (C) 2017, BA3, LLC ALL RIGHTS RESERVED</p>
    </div>


    <script src="js/contents.js"></script>
    <script src="js/sidebar.js"></script>
    <script src="js/prism.js"></script>

<script>
<!--
//Activate the current side bar list item
document.getElementById('PositionAndOrientation').className="active";
//Activate the current OS in the top nav bar
document.getElementById('Web').className="active";
-->
</script>


</body>
</html>
